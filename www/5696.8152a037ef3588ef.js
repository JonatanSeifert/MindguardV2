"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5696],{1208:(L,N,d)=>{d.d(N,{_8:()=>p,on:()=>v,wd:()=>m});var p=function(h){return h.Prompt="PROMPT",h.Camera="CAMERA",h.Photos="PHOTOS",h}(p||{}),m=function(h){return h.Rear="REAR",h.Front="FRONT",h}(m||{}),v=function(h){return h.Uri="uri",h.Base64="base64",h.DataUrl="dataUrl",h}(v||{})},4120:(L,N,d)=>{d.d(N,{Ut:()=>v,_8:()=>m._8,on:()=>m.on});var p=d(6400),m=d(1208);const v=(0,p.C_)("Camera",{web:()=>d.e(9028).then(d.bind(d,9028)).then(h=>new h.CameraWeb)})},5696:(L,N,d)=>{d.d(N,{o:()=>ae});var p=d(1528),m=d(692),v=d(1024),h=d(7808),k=d(4120),G=d(6400),C=function(e){return e.Accessibility="accessibility",e.Account="account",e.AirplaneMode="airplane_mode",e.Apn="apn",e.ApplicationDetails="application_details",e.ApplicationDevelopment="application_development",e.Application="application",e.AppNotification="app_notification",e.BatteryOptimization="battery_optimization",e.Bluetooth="bluetooth",e.Captioning="captioning",e.Cast="cast",e.DataRoaming="data_roaming",e.Date="date",e.Display="display",e.Dream="dream",e.Home="home",e.Keyboard="keyboard",e.KeyboardSubType="keyboard_subtype",e.Locale="locale",e.Location="location",e.ManageApplications="manage_applications",e.ManageAllApplications="manage_all_applications",e.MemoryCard="memory_card",e.Network="network",e.NfcSharing="nfcsharing",e.NfcPayment="nfc_payment",e.NfcSettings="nfc_settings",e.Print="print",e.Privacy="privacy",e.QuickLaunch="quick_launch",e.Search="search",e.Security="security",e.Settings="settings",e.ShowRegulatoryInfo="show_regulatory_info",e.Sound="sound",e.Storage="storage",e.Sync="sync",e.Usage="usage",e.UserDictionary="user_dictionary",e.VoiceInput="voice_input",e.Wifi="wifi",e.WifiIp="wifi_ip",e.Wireless="wireless",e}(C||{}),x=function(e){return e.About="about",e.App="app",e.AutoLock="autoLock",e.Bluetooth="bluetooth",e.DateTime="dateTime",e.FaceTime="facetime",e.General="general",e.Keyboard="keyboard",e.ICloud="iCloud",e.ICloudStorageBackup="iCloudStorageBackup",e.International="international",e.LocationServices="locationServices",e.Music="music",e.Notes="notes",e.Notifications="notifications",e.Phone="phone",e.Photos="photos",e.ManagedConfigurationList="managedConfigurationList",e.Reset="reset",e.Ringtone="ringtone",e.Sounds="sounds",e.SoftwareUpdate="softwareUpdate",e.Store="store",e.Tracking="tracking",e.Wallpaper="wallpaper",e.WiFi="wifi",e.Tethering="tethering",e.DoNotDisturb="doNotDisturb",e.TouchIdPasscode="touchIdPasscode",e}(x||{});const M=(0,G.C_)("NativeSettings",{web:()=>d.e(776).then(d.bind(d,776)).then(e=>new e.NativeSettingsWeb)}),D=(0,G.C_)("Geolocation",{web:()=>d.e(6360).then(d.bind(d,6360)).then(e=>new e.GeolocationWeb)});var $=d(3252),K=d(800),O={error:"cordova_not_available"},H={error:"plugin_not_installed"};function R(e){if(typeof window<"u"&&window.angular){var t=window.document,r=window.angular.element(t.querySelector("[ng-app]")||t.body).injector();if(r)return r.get("$q")(function(i,a){e(i,a)});console.warn("Angular 1 was detected but $q couldn't be retrieved. This is usually when the app is not bootstrapped on the html or body tag. Falling back to native promises which won't trigger an automatic digest when promises resolve.")}return function(){if(Promise)return new Promise(function(i,a){e(i,a)});console.error("No Promise support or polyfill found. To enable Ionic Native support, please add the es6-promise polyfill before this script, or run with a library like Angular or on a recent browser.")}()}function B(e,n,t){var r,o;"string"==typeof e?r=e:(r=e.constructor.getPluginRef(),t=e.constructor.getPluginName(),o=e.constructor.getPluginInstallName());var i=E(r);return!(!i||n&&typeof i[n]>"u")||(typeof window>"u"||!window.cordova?(function q(e,n){typeof process>"u"&&console.warn(n?"Native: tried calling "+e+"."+n+", but Cordova is not available. Make sure to include cordova.js or run in a device/simulator":"Native: tried accessing the "+e+" plugin but Cordova is not available. Make sure to include cordova.js or run in a device/simulator")}(t,n),O):(function Y(e,n,t){console.warn(t?"Native: tried calling "+e+"."+t+", but the "+e+" plugin is not installed.":"Native: tried accessing the "+e+" plugin but it's not installed."),n&&console.warn("Install the "+e+" plugin: 'ionic cordova plugin add "+n+"'")}(t,o,n),H))}function P(e,n,t,r,o,i){void 0===r&&(r={}),t=function I(e,n,t,r){if(void 0===n&&(n={}),n.sync)return e;if("reverse"===n.callbackOrder)e.unshift(r),e.unshift(t);else if("node"===n.callbackStyle)e.push(function(u,l){u?r(u):t(l)});else if("object"===n.callbackStyle&&n.successName&&n.errorName){var o={};o[n.successName]=t,o[n.errorName]=r,e.push(o)}else if(typeof n.successIndex<"u"||typeof n.errorIndex<"u"){var i=function(){n.successIndex>e.length?e[n.successIndex]=t:e.splice(n.successIndex,0,t)},a=function(){n.errorIndex>e.length?e[n.errorIndex]=r:e.splice(n.errorIndex,0,r)};n.successIndex>n.errorIndex?(a(),i()):(i(),a())}else e.push(t),e.push(r);return e}(t,r,o,i);var a=B(e,n);if(!0===a){var u=E(e.constructor.getPluginRef());return u[n].apply(u,t)}return a}function E(e){return typeof window<"u"?W(window,e):null}function W(e,n){for(var t=n.split("."),r=e,o=0;o<t.length;o++){if(!r)return null;r=r[t[o]]}return r}var _=function(){function e(){}return e.installed=function(){return!0===B(this.pluginRef)},e.getPlugin=function(){return typeof window<"u"?function S(e,n){for(var t=n.split("."),r=e,o=0;o<t.length;o++){if(!r)return null;r=r[t[o]]}return r}(window,this.pluginRef):null},e.getPluginName=function(){return this.pluginName},e.getPluginRef=function(){return this.pluginRef},e.getPluginInstallName=function(){return this.plugin},e.getSupportedPlatforms=function(){return this.platforms},e.pluginName="",e.pluginRef="",e.plugin="",e.repo="",e.platforms=[],e.install="",e}();function J(e,n,t,r){return function(e,n,t){return void 0===t&&(t={}),function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t.sync?P(e,n,r,t):t.observable?function Q(e,n,t,r){return void 0===r&&(r={}),new $._(function(o){var i;return i=r.destruct?P(e,n,t,r,function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return o.next(a)},function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return o.error(a)}):P(e,n,t,r,o.next.bind(o),o.error.bind(o)),i&&i.error&&(o.error(i.error),o.complete()),function(){try{if(r.clearFunction)return r.clearWithArgs?P(e,r.clearFunction,t,r,o.next.bind(o),o.error.bind(o)):P(e,r.clearFunction,[])}catch(a){console.warn("Unable to clear the previous observable watch for",e.constructor.getPluginName(),n),console.warn(a)}}})}(e,n,r,t):t.eventObservable&&t.event?function Z(e,n){return n=typeof window<"u"&&n?W(window,n):n||(typeof window<"u"?window:{}),(0,K.w)(n,e)}(t.event,t.element):t.otherPromise?function z(e,n,t,r){return void 0===r&&(r={}),R(function(o,i){var a=P(e,n,t,r);a?a.error?i(a.error):a.then&&a.then(o).catch(i):i({error:"unexpected_error"})})}(e,n,r,t):function V(e,n,t,r){void 0===r&&(r={});var o,i,a=R(function(u,l){o=r.destruct?P(e,n,t,r,function(){for(var c=[],s=0;s<arguments.length;s++)c[s]=arguments[s];return u(c)},function(){for(var c=[],s=0;s<arguments.length;s++)c[s]=arguments[s];return l(c)}):P(e,n,t,r,u,l),i=l});return o&&o.error&&(a.catch(function(){}),"function"==typeof i&&i(o.error)),a}(e,n,r,t)}}(e,n,t).apply(this,r)}!function A(){if(typeof process>"u"){var e=typeof window<"u"?window:{},t=Date.now(),r=!1;e.document.addEventListener("deviceready",function(){console.log("Ionic Native: deviceready event fired after "+(Date.now()-t)+" ms"),r=!0}),setTimeout(function(){!r&&e.cordova&&console.warn("Ionic Native: deviceready did not fire within 5000ms. This can happen when plugins are in an inconsistent state. Try removing plugins from plugins/ and reinstalling them.")},5e3)}}();var re=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),te=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return re(n,e),n.prototype.reverseGeocode=function(t,r,o){return J(this,"reverseGeocode",{callbackOrder:"reverse"},arguments)},n.prototype.forwardGeocode=function(t,r){return J(this,"forwardGeocode",{callbackOrder:"reverse"},arguments)},n.pluginName="NativeGeocoder",n.plugin="cordova-plugin-nativegeocoder",n.pluginRef="nativegeocoder",n.repo="https://github.com/sebastianbaar/cordova-plugin-nativegeocoder",n.platforms=["iOS","Android"],n}(_)),b=d(4496),oe=d(8244),ie=d(2112);let ae=(()=>{var e;class n{constructor(r,o,i,a,u){this.auth=r,this.firestore=o,this.router=i,this.alertctrl=a,this.storage=u,this.data="",this.profilepic="https://ionicframework.com/docs/img/demos/avatar.svg",this.finalarray=[],this.decoderoptions={useLocale:!0,maxResults:1},this.authstates=(0,m.EB)(this.auth).subscribe(l=>{l&&(this.userdatsub=this.getUserData().subscribe(c=>{if(c&&(this.data=c,1==l.emailVerified)){if(this.profilepic=null==c.profilepicurl||""==c.profilepicurl?"https://ionicframework.com/docs/img/demos/avatar.svg":c.profilepicurl,null==c.program){const s=this.auth.currentUser,f=(0,v.UN)(this.firestore,`profile/${null==s?void 0:s.uid}`);(0,v.Sm)(f,{program:JSON.stringify([{name:"Breathing Exercise",helpfullness:0},{name:"3-3-3 Rule",helpfullness:0}])},{merge:!0})}this.updateProtocol(),("/login"==i.url||"/register"==i.url||"/passwordreset"==i.url||"/"==i.url)&&i.navigateByUrl("/home")}}))})}createUserData(r,o){var i=this;return(0,p.c)(function*(){const a=i.auth.currentUser,u=(0,v.UN)(i.firestore,`profile/${null==a?void 0:a.uid}`);(yield(0,v.i4)(u)).exists()||(yield(0,v.Sm)(u,{name:r,email:o}))})()}getUser(){return this.auth.currentUser}getUserData(){const r=this.auth.currentUser,o=(0,v.UN)(this.firestore,`profile/${null==r?void 0:r.uid}`);return(0,v.gZ)(o)}register(r,o,i){var a=this;return(0,p.c)(function*(){try{const u=yield(0,m.UH)(a.auth,r,o);return(0,m.qg)(u.user,{displayName:i}),u}catch{return null}})()}login(r,o){var i=this;return(0,p.c)(function*(){try{return(0,m.kJ)(i.auth,r,o)}catch{return null}})()}logout(){var r=this;return(0,p.c)(function*(){r.userdatsub.unsubscribe(),yield(0,m.Az)(r.auth),r.router.navigateByUrl("/",{replaceUrl:!0})})()}sendVerificationEmail(){var r=this;return(0,p.c)(function*(){return r.auth.currentUser?(0,m.ML)(r.auth.currentUser):null})()}resetPassword(r){var o=this;return(0,p.c)(function*(){return yield(0,m.Yr)(o.auth,r)})()}updateSos(r,o,i,a,u,l){var c=this;return(0,p.c)(function*(){const s=c.auth.currentUser,f=(0,v.UN)(c.firestore,`profile/${null==s?void 0:s.uid}`);let g=c.data.program,U=[];null!=g&&(U=JSON.parse(g));let F=!1;for(let y of U)y.name==r&&(o?"stay"==i||("change"==i?y.helpfullness+=2:y.helpfullness++):"stay"==i||("change"==i?y.helpfullness-=2:y.helpfullness--),F=!0);F||U.push(o?{name:r,helpfullness:1}:{name:r,helpfullness:0}),yield(0,v.Sm)(f,{program:JSON.stringify(U)},{merge:!0});let T=JSON.parse(c.data.protocol);for(let y of T)y.dateTime==a&&(y.name=u,y.description=l,y.topflop=o);c.data.protocol=JSON.stringify(T),yield(0,v.Sm)(f,{protocol:JSON.stringify(T)},{merge:!0})})()}addSOS(r,o){var i=this;return(0,p.c)(function*(){let l,a=i.data.protocol,u=[];null!=a&&(u=JSON.parse(a)),console.log("start loc"),l={name:"Auto Generated",location:yield i.getCloseLocation(),dateTime:o,usedExercise:r},u.push(l);const f=i.auth.currentUser,g=(0,v.UN)(i.firestore,`profile/${null==f?void 0:f.uid}`);yield(0,v.Sm)(g,{protocol:JSON.stringify(u)},{merge:!0})})()}deleteSOS(r){var o=this;return(0,p.c)(function*(){let i=r.dateTime;console.log(i);let u,a=JSON.parse(o.data.protocol);for(let s of a)s.dateTime==i&&(u=s);if(console.log(a.indexOf(u)),-1==a.indexOf(u))return o.finalarray=[],void o.updateProtocol();a.splice(a.indexOf(u),1),o.data.protocol=JSON.stringify(a);const l=o.auth.currentUser,c=(0,v.UN)(o.firestore,`profile/${null==l?void 0:l.uid}`);yield(0,v.Sm)(c,{protocol:JSON.stringify(a)},{merge:!0})})()}updateProtocol(){let o=this.data.protocol,i=[];if(null!=o&&(i=JSON.parse(o)),0==i.length)return;let a=[];for(let l of i){let c=new Date(l.dateTime).toISOString().split("T")[0];-1==a.indexOf(c)&&a.push(c)}const u=a.map(l=>new Date(l));u.sort((l,c)=>c.getTime()-l.getTime()),a=u.map(l=>l.toISOString()),this.finalarray=[];for(let l of a){let c=[];for(let s of i)new Date(s.dateTime).toISOString().split("T")[0]==new Date(l).toISOString().split("T")[0]&&c.push(s);c.reverse(),this.finalarray.push({date:l,logs:c})}}checkAndRequestPermissions(){var r=this;return(0,p.c)(function*(){const o=yield k.Ut.checkPermissions();if("granted"!=o.camera||"granted"!=o.photos){const a=yield k.Ut.requestPermissions();("granted"!=a.camera||"granted"!=a.photos)&&(yield(yield r.alertctrl.create({header:"Permission denied",subHeader:"please give Mindguard permissions",message:"Mindguard was created to give immediate help. Permissions Request could cost valueable seconds",backdropDismiss:!1,buttons:[{text:"Give Permission",handler:()=>{M.open({optionAndroid:C.ApplicationDetails,optionIOS:x.App})}}]})).present())}"granted"!=(yield D.checkPermissions()).location&&"granted"!=(yield D.requestPermissions()).location&&(yield(yield r.alertctrl.create({header:"Permission denied",subHeader:"please give Mindguard permissions",message:"Mindguard was created to give immediate help. Permissions Request could cost valueable seconds",backdropDismiss:!1,buttons:[{text:"Give Permission",handler:()=>{M.open({optionAndroid:C.ApplicationDetails,optionIOS:x.App})}}]})).present()),console.log(r.getCloseLocation())})()}saveNewUserSettings(r,o){var i=this;return(0,p.c)(function*(){const a=i.auth.currentUser,u=(0,v.UN)(i.firestore,`profile/${null==a?void 0:a.uid}`),l=yield i.uploadPhoto(o);yield(0,v.Sm)(u,{name:r,profilepicurl:l},{merge:!0})})()}uploadPhoto(r){var o=this;return(0,p.c)(function*(){console.log();const i=o.auth.currentUser,a=(0,h.IL)(o.storage,`uploads/${null==i?void 0:i.uid}/profile.png`);try{return yield(0,h.K)(a,r,"base64"),(0,h.Kq)(a)}catch{return""}})()}getCloseLocation(){var r=this;return(0,p.c)(function*(){const i=yield D.getCurrentPosition({enableHighAccuracy:!1});console.log("gotloc"),te.reverseGeocode(i.coords.latitude,i.coords.longitude,r.decoderoptions).then(a=>(console.log(a[0].areasOfInterest[0]),a[0].areasOfInterest[0]))})()}}return(e=n).\u0275fac=function(r){return new(r||e)(b.CoB(m.sL),b.CoB(v.OI),b.CoB(oe.E5),b.CoB(ie.iW),b.CoB(h.u_))},e.\u0275prov=b.wxM({token:e,factory:e.\u0275fac,providedIn:"root"}),n})()}}]);